<mvc:View
    controllerName="zdomscrapmovements.controller.MainView"
    xmlns:smarttable="sap.ui.comp.smarttable"
    xmlns:smartfilterbar="sap.ui.comp.smartfilterbar"
    xmlns:smartMultiInput="sap.ui.comp.smartmultiinput"
    xmlns:core="sap.ui.core"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:table="sap.ui.table"
    xmlns="sap.m"
>
    <Page id="page">
        <smartfilterbar:SmartFilterBar
            id="smartFilterBar"
            fieldGroupIds="FILTERS"
            entitySet="ScrapMovements"
            persistencyKey="Smart_Variants"
            search="onSearch"
            filterBarExpanded="true"
            afterVariantSave="onSmartFilterBarAfterVariantSave"
            afterVariantLoad="onSmartFilterBarAfterVariantLoad"
        >
            <smartfilterbar:controlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="ProductionOrder"
                    label="{i18n>productionOrder}"
                    visibleInAdvancedArea="true"
                    hasValueHelpDialog="true"
                >
                    <smartfilterbar:customControl>
                        <MultiInput
                            id="ProductionOrder"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            change="onChange"
                            tokenUpdate="onTokenUpdate"
                            tokens="{AppJsonModel>/FilterValues/ProductionOrder}"
                            width="100%"
                        >
                            <tokens>
                                <Token
                                    key="{AppJsonModel>key}"
                                    text="{AppJsonModel>text}"
                                />
                            </tokens>
                        </MultiInput>
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="ProductionOperation"
                    label="{i18n>productionOrderOp}"
                    visibleInAdvancedArea="true"
                    hasValueHelpDialog="true"
                >
                    <smartfilterbar:customControl>
                        <!-- <Input
                            id="ProductOrderOperation"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            value="{AppJsonModel>/FilterValues/ProductOrderOperation}"
                        /> -->
                        <MultiInput
                            id="ProductOrderOperation"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            tokenUpdate="onTokenUpdate"
                            change="onChange"
                            tokens="{AppJsonModel>/FilterValues/ProductOrderOperation}"
                            width="100%"
                        >
                            <tokens>
                                <Token
                                    key="{AppJsonModel>key}"
                                    text="{AppJsonModel>text}"
                                />
                            </tokens>
                        </MultiInput>
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="Plant"
                    visibleInAdvancedArea="true"
                    hasValueHelpDialog="true"
                >
                    <smartfilterbar:customControl>
                        <!-- <Input
                            id="Plant"
                            showValueHelp="true"
                            change="onChange"
                            valueHelpRequest="onValueHelpRequest"
                            value="{AppJsonModel>/FilterValues/Plant}"
                        /> -->

                        <MultiInput
                            id="Plant"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            tokens="{AppJsonModel>/FilterValues/Plant}"
                            tokenUpdate="onTokenUpdate"
                            change="onChange"
                            width="100%"
                        >
                            <tokens>
                                <Token
                                    key="{AppJsonModel>key}"
                                    text="{AppJsonModel>text}"
                                />
                            </tokens>
                        </MultiInput>
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="WorkCenter"
                    visibleInAdvancedArea="true"
                    hasValueHelpDialog="true"
                >
                    <smartfilterbar:customControl>
                        <!-- <Input
                            id="WorkCenter"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            change="onChange"
                            value="{AppJsonModel>/FilterValues/WorkCenter}"
                        /> -->

                        <MultiInput
                            id="WorkCenter"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            tokens="{AppJsonModel>/FilterValues/WorkCenter}"
                            tokenUpdate="onTokenUpdate"
                            change="onChange"
                            width="100%"
                        >
                            <tokens>
                                <Token
                                    key="{AppJsonModel>key}"
                                    text="{AppJsonModel>text}"
                                />
                            </tokens>
                        </MultiInput>
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="StorageLocation"
                    visibleInAdvancedArea="true"
                    hasValueHelpDialog="true"
                >
                    <smartfilterbar:customControl>
                        <!-- <Input
                            id="StorageLocation"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            value="{AppJsonModel>/FilterValues/StorageLocation}"
                        /> -->

                        <MultiInput
                            id="StorageLocation"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            tokens="{AppJsonModel>/FilterValues/StorageLocation}"
                            tokenUpdate="onTokenUpdate"
                            change="onChange"
                            width="100%"
                        >
                            <tokens>
                                <Token
                                    key="{AppJsonModel>key}"
                                    text="{AppJsonModel>text}"
                                />
                            </tokens>
                        </MultiInput>
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="Component"
                    label="{i18n>material}"
                    visibleInAdvancedArea="true"
                    hasValueHelpDialog="true"
                >
                    <smartfilterbar:customControl>
                        <!-- <Input
                            id="Material"
                            showValueHelp="true"
                            change="onChange"
                            valueHelpRequest="onValueHelpRequest"
                            value="{AppJsonModel>/FilterValues/Material}"
                        /> -->

                        <MultiInput
                            id="Material"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            tokens="{AppJsonModel>/FilterValues/Material}"
                            tokenUpdate="onTokenUpdate"
                            change="onChange"
                            width="100%"
                        >
                            <tokens>
                                <Token
                                    key="{AppJsonModel>key}"
                                    text="{AppJsonModel>text}"
                                />
                            </tokens>
                        </MultiInput>
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="SerialNumber"
                    label="{i18n>serialNumber}"
                    visibleInAdvancedArea="true"
                    hasValueHelpDialog="true"
                >
                    <smartfilterbar:customControl>
                        <!-- <Input
                            id="SerialNumber"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            value="{AppJsonModel>/FilterValues/SerialNumber}"
                        /> -->

                        <MultiInput
                            id="SerialNumber"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            tokens="{AppJsonModel>/FilterValues/SerialNumber}"
                            tokenUpdate="onTokenUpdate"
                            change="onChange"
                            width="100%"
                        >
                            <tokens>
                                <Token
                                    key="{AppJsonModel>key}"
                                    text="{AppJsonModel>text}"
                                />
                            </tokens>
                        </MultiInput>
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="Zuser"
                    label="{i18n>user}"
                    visibleInAdvancedArea="true"
                    hasValueHelpDialog="true"
                >
                    <smartfilterbar:customControl>
                        <!-- <Input
                            id="Zuser"
                            showValueHelp="true"
                            change="onChange"
                            valueHelpRequest="onValueHelpRequest"
                            value="{AppJsonModel>/FilterValues/Zuser}"
                        /> -->

                        <MultiInput
                            id="Zuser"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            change="onChange"
                            submit="onMultiInputSubmit"
                            tokenUpdate="onTokenUpdate"
                            tokens="{AppJsonModel>/FilterValues/Zuser}"
                            width="100%"
                        >
                            <tokens>
                                <Token
                                    key="{AppJsonModel>key}"
                                    text="{AppJsonModel>text}"
                                />
                            </tokens>
                        </MultiInput>
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="ReferenceNumber"
                    visibleInAdvancedArea="true"
                >
                    <smartfilterbar:customControl>
                        <!-- <Input
                            id="ReferenceNumber"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                        /> -->

                        <MultiInput
                            id="ReferenceNumber"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            tokens="{AppJsonModel>/FilterValues/ReferenceNumber}"
                            tokenUpdate="onTokenUpdate"
                            change="onChange"
                            width="100%"
                        >
                            <tokens>
                                <Token
                                    key="{AppJsonModel>key}"
                                    text="{AppJsonModel>text}"
                                />
                            </tokens>
                        </MultiInput>
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="Equipment"
                    visibleInAdvancedArea="true"
                >
                    <smartfilterbar:customControl>
                        <!-- <Input
                            id="Equipment"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                        /> -->
                        <MultiInput
                            id="Equipment"
                            showValueHelp="true"
                            valueHelpRequest="onValueHelpRequest"
                            tokens="{AppJsonModel>/FilterValues/Equipment}"
                            tokenUpdate="onTokenUpdate"
                            change="onChange"
                            width="100%"
                        >
                            <tokens>
                                <Token
                                    key="{AppJsonModel>key}"
                                    text="{AppJsonModel>text}"
                                />
                            </tokens>
                        </MultiInput>
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="DateFrom"
                    label="{i18n>releaseDate}"
                    visibleInAdvancedArea="true"
                    controlType="date"
                >
                    <smartfilterbar:customControl>
                        <DatePicker
                            displayFormat="dd.MM.yyyy"
                            valueFormat="yyyy-MM-ddThh:mm:ss"
                        />
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
                <smartfilterbar:ControlConfiguration
                    groupId="FILTERS"
                    key="DateTo"
                    label="{i18n>releaseDateTo}"
                    visibleInAdvancedArea="true"
                    controlType="dateTimePicker"
                >
                    <smartfilterbar:customControl>
                        <DatePicker
                            displayFormat="dd.MM.yyyy"
                            valueFormat="yyyy-MM-ddThh:mm:ss"
                        />
                    </smartfilterbar:customControl>
                </smartfilterbar:ControlConfiguration>
            </smartfilterbar:controlConfiguration>
        </smartfilterbar:SmartFilterBar>

        <ScrollContainer
            height="100%"
            vertical="true"
        >
            <smarttable:SmartTable
                id="smartTable"
                header="{i18n>header}"
                smartFilterId="smartFilterBar"
                entitySet="ScrapMovements"
                initiallyVisibleFields="BlockedQuantity,ScrapQuantity,FreeQuantity,Reason,CostCenter,ProductionOrder,ProductionOperation,Time,Zuser,Component,Plant,WorkCenter,StorageLocation,DateFrom,SerialNumber,Element,Cause,RepairCode,Equipment,EquipmentDescription,DNIEquipment"
                requestAtLeastFields="ProductionOrder,ProductionOperation,Charg,Component,ItemNumber,StorageLocation,NotificationType,NotificationNumber,SerialNumber,UnitOfMeasure,Plant,ReserveNumber,Quantity,Material,BomNumber,ReferenceNumber,Equipment,EquipmentDescription,DNIEquipment"
                height="100%"
                persistencyKey="SmartTable_Explored"
                beforeRebindTable="beforeRebind"
                enableAutoColumnWidth="true"
            >
                <smarttable:layoutData>
                    <FlexItemData
                        growFactor="1"
                        baseSize="0%"
                    />
                </smarttable:layoutData>

                <smarttable:customToolbar>
                    <Toolbar id="_IDGenToolbar">
                        <ToolbarSpacer id="_IDGenToolbarSpacer" />
                        <Button
                            id="scrapToFreeBtn"
                            type="Accept"
                            icon="sap-icon://initiative"
                            enabled="false"
                            tooltip="{i18n>scrapToFree}"
                            text="{i18n>scrapToFree}"
                            press="onScrapToFreeButtonPress"
                        />
                        <Button
                            id="MassFillFields"
                            type="Transparent"
                            icon="sap-icon://add-process"
                            press="onValueHelpMassFillDialog"
                            enabled="false"
                            tooltip="{i18n>massFill}"
                            text="{i18n>massFillText}"
                        />
                    </Toolbar>
                </smarttable:customToolbar>

                <Table
                    id="table"
                    mode="MultiSelect"
                    selectionChange="onSelectionChange"
                    sticky="ColumnHeaders,HeaderToolbar"
                    growing="true"
                    width="3500px"
                    growingScrollToLoad="true"
                    growingThreshold="1500"
                >
                    <columns>
                        <Column width="100px">
                            <customData>
                                <core:CustomData
                                    key="p13nData"
                                    value='\{"columnKey": "BlockedQuantity", "leadingProperty": "BlockedQuantity"}'
                                />
                            </customData>
                            <Text
                                text="{/#ScrapMovementsType/BlockedQuantity/@sap:label}"
                            />
                        </Column>

                        <Column width="100px">
                            <customData>
                                <core:CustomData
                                    key="p13nData"
                                    value='\{"columnKey": "ScrapQuantity", "leadingProperty": "ScrapQuantity"}'
                                />
                            </customData>
                            <Text
                                text="{i18n>scrapQuantity}"
                            />
                        </Column>

                        <Column width="100px">
                            <customData>
                                <core:CustomData
                                    key="p13nData"
                                    value='\{"columnKey": "FreeQuantity", "leadingProperty": "FreeQuantity"}'
                                />
                            </customData>
                            <Text
                                text="{/#ScrapMovementsType/FreeQuantity/@sap:label}"
                            />
                        </Column>

                        <Column width="150px">
                            <customData>
                                <core:CustomData
                                    key="p13nData"
                                    value='\{"columnKey": "Reason", "leadingProperty": "Reason"}'
                                />
                            </customData>
                            <Text
                                text="{/#ScrapMovementsType/Reason/@sap:label}"
                            />
                        </Column>

                        <Column width="150px">
                            <customData>
                                <core:CustomData
                                    key="p13nData"
                                    value='\{"columnKey": "CostCenter", "leadingProperty": "CostCenter"}'
                                />
                            </customData>
                            <Text
                                text="{/#ScrapMovementsType/CostCenter/@sap:label}"
                            />
                        </Column>
                        <Column width="100px">
                            <customData>
                                <core:CustomData
                                    key="p13nData"
                                    value='\{"columnKey": "DateFrom", "leadingProperty": "DateFrom"}'
                                />
                            </customData>
                            <Text
                                text="{/#ScrapMovementsType/DateFrom/@sap:label}"
                            />
                        </Column>
                        <Column width="100px">
                            <customData>
                                <core:CustomData
                                    key="p13nData"
                                    value='\{"columnKey": "Time", "leadingProperty": "Time"}'
                                />
                            </customData>
                            <Text
                                text="{/#ScrapMovementsType/Time/@sap:label}"
                            />
                        </Column>
                    </columns>

                    <items>
                        <ColumnListItem>
                            <cells>
                                <Text
                                    id="blockedQty"
                                    text="{BlockedQuantity}"
                                />
                            </cells>
                            <cells>
                                <Input
                                    id="scrapQty"
                                    value="{BlockedQuantity}"
                                    type="Number"
                                    editable="true"
                                    change="onFormatValue"
                                    maxLength="5"
                                />
                            </cells>
                            <cells>
                                <Input
                                    id="freeQty"
                                    value="{FreeQuantity}"
                                    type="Number"
                                    editable="true"
                                    change="onFormatValue"
                                    maxLength="5"
                                />
                            </cells>
                            <cells>
                                <Input
                                    id="Reason"
                                    type="Number"
                                    editable="true"
                                    showValueHelp="true"
                                    valueHelpRequest="onValueHelpRequestInputsTable"
                                    valueStateText="{i18n>reasonRequired}"
                                    change="onReasonChange"
                                    maxLength="4"
                                />
                            </cells>
                            <cells>
                                <Input
                                    id="CostCenter"
                                    type="Text"
                                    editable="true"
                                    showValueHelp="true"
                                    valueHelpRequest="onValueHelpRequestInputsTable"
                                    valueStateText="{i18n>costCenterRequired}"
                                    change="onCostCenterChange"
                                />
                            </cells>
                            <cells>
                                <Text
                                    text="{path: 'DateFrom', formatter: '.formatter.formatDateByLocale'}"
                                />
                            </cells>
                            <cells>
                                <Text
                                    text="{path: 'Time', formatter: '.formatter.formatEdmTimeByLocale'}"
                                />
                            </cells>
                        </ColumnListItem>
                    </items>
                </Table>
            </smarttable:SmartTable>
        </ScrollContainer>
        <footer>
            <OverflowToolbar>
                <Button
                    id="messagePopoverBtn"
                    icon="sap-icon://notification-2"
                    text="{popoverModel>/messageLength}"
                    type="{popoverModel>/type}"
                    press=".handleMessagePopoverPress"
                    ariaHasPopup="Dialog"
                    enabled="false"
                />
                <ToolbarSpacer />
                <Button
                    id="stockTransferBtn"
                    class="sapUiSmallMarginBeginEnd"
                    text="{i18n>stockTransferBtn}"
                    enabled="false"
                    press="checkTransferMovement"
                    type="Emphasized"
                />
            </OverflowToolbar>
        </footer>
    </Page>
</mvc:View>
